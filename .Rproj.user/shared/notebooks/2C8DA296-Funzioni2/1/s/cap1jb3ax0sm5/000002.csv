"0","cor.check.num <- function(x, y, data=NULL, "
"0","                                  stats=F, "
"0","                                  whichStats=c(""pearson"", ""spearman""), # pearson, spearman, kenadal"
"0","                                  whichTests=c(), # pearson, spearman, kenadal"
"0","                                  doPlot=T) {"
"0","  "
"0","  if (!is.null(data)) {"
"0","    xname <- x"
"0","    yname <- y"
"0","    x <- data[[x]]"
"0","    y <- data[[y]]"
"0","  } else {"
"0","    xname <- deparse(substitute(x))"
"0","    yname <- deparse(substitute(y))"
"0","  }"
"0","  "
"0","  # (eventuale) print delle statistiche"
"0","  if (isTRUE(stats)) {"
"0","    "
"0","    print(paste(""ANALISI PRELIMINARE DELLA CORRELAZIONE"", yname, ""~"", xname))"
"0","    "
"0","    s <- table(c())"
"0","    "
"0","    # s[""Cov.""] <- cov(x, y)"
"0","    "
"0","    for (stat in whichStats) {"
"0","      "
"0","      s[stat] <- cor(x, y, method = stat)"
"0","    }"
"0","    "
"0","    print(s)"
"0","  }"
"0","  "
"0","  # (eventuali) test sulle statistiche"
"0","  for (t in whichTests) {"
"0","    print(cor.test(x, y, method = t))"
"0","  }"
"0","  "
"0","  "
"0","  if (isTRUE(doPlot)) {"
"0","    # plot di correlazione tra var numeriche"
"0","    plot(y~x, main=paste(yname, ""~"", xname), xlab = xname, ylab = yname)"
"0","    abline(lm(y~x), col=""red"")"
"0","    lines(lowess(y~x), col=""blue"")"
"0","  }"
"0","}"
"0",""
"0","# cor.check.num(x=""disp"", y=""mpg"", data=mtcars, stats = T, whichTests = c(""pearson""))"
"0",""
