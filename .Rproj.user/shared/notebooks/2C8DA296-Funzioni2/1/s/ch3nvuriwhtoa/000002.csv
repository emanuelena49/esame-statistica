"0","cor.check.factor.num <- function(xfactor, y, data=NULL, stats=F, doPlot=T, doPlotLines=F, "
"0","                                 doMeanTest=F, doAnova=F) {"
"0","  "
"0","  if (!is.null(data)) {"
"0","    xname <- xfactor"
"0","    yname <- y"
"0","    xfactor <- data[[xfactor]]"
"0","    y <- data[[y]]"
"0","  } else {"
"0","    xname <- deparse(substitute(xfactor))"
"0","    yname <- deparse(substitute(y))"
"0","  }"
"0","  "
"0","  # (eventuali) statistiche per gruppo "
"0","  if (isTRUE(stats)) {"
"0","    "
"0","    print(paste(""ANALISI PRELIMINARE DELLA CORRELAZIONE"", yname, ""~"", xname))"
"0","    "
"0","    print(tapply(y, xfactor, summary.num))"
"0","    "
"0","    # s[[""Mean""]] <- tapply(y, xfactor, mean)"
"0","    # s[[""Median""]] <- tapply(y, xfactor, median)"
"0","    # s[[""Var.""]] <- tapply(y, xfactor, var)"
"0","    # s[[""Std.Dev.""]] <- tapply(y, xfactor, sd)"
"0","    # print(s)"
"0","  }"
"0","  "
"0","  if(isTRUE(doMeanTest)) {"
"0","    print(t.test.between.groups(xname, yname, data=data))"
"0","  }"
"0","  "
"0","  if(isTRUE(doAnova)) {"
"0","    m <- aov(y~xfactor)"
"0","    print(summary(m))"
"0","    # print(summary.lm(m))"
"0","  }"
"0","  "
"0","  # (eventua)"
"0","  "
"0","  if (isTRUE(doPlot)) {"
"0","    boxplot(y~xfactor, main=paste(yname, ""~"", xname), xlab = xname, ylab = yname, col=NULL)"
"0","    "
"0","    if (isTRUE(doPlotLines)) {"
"0","      abline(lm(y~xfactor), col=""red"")"
"0","      # lines(lowess(y~xfactor), col=""blue"")"
"0","    }"
"0","  }"
"0","}"
"0",""
"0","# cor.check.factor.num(xfactor = ""carb"", y=""mpg"", data=mtcars, stats=T, doPlot=T, doPlotLines=T)"
