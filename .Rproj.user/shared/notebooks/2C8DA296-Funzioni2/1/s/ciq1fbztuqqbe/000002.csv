"0","gsummary.factor <- function(x, data=NULL, stats=F, "
"0","                              plots=c(""rel"", ""pie""), # values: abs | rel | pie  "
"0","                              pieLabels=T"
"0","                               ) {"
"0","  "
"0","  if (!is.null(data)) {"
"0","    varname <- x"
"0","    x <- data[[x]]"
"0","    len <- nrow(data)"
"0","  } else {"
"0","    len <- length(x)"
"0","    varname <- deparse(substitute(x))"
"0","  }"
"0","  "
"0","  # (eventuale) print delle statistiche"
"0","  if (isTRUE(stats)) {"
"0","    print(paste(""SINTESI DI"", varname))"
"0","    print(summary.factor(x))"
"0","  }"
"0","  "
"0","  if(""abs"" %in% plots) {"
"0","    # Barplot con freq assolute"
"0","      barplot(table(x), main = paste(""Frequenze di"", varname), xlab = varname)"
"0","  }"
"0","  "
"0","  if(""rel"" %in% plots) {"
"0","    # Barplot con freq relative"
"0","    barplot(table(x)/len, main = paste(""ProbabilitÃ  di"", varname), xlab = varname)"
"0","  }"
"0","  "
"0","  if(""pie"" %in% plots) {"
"0","    # grafico a torta"
"0","    tbl.as.df <- as.data.frame(table(x))"
"0","    "
"0","    tbl.as.df$Prob <- tbl.as.df$Freq/len"
"0","    "
"0","    if(isTRUE(pieLabels)) {"
"0","      tbl.as.df$labels <- paste(tbl.as.df[[1]], "": f="", tbl.as.df$Freq, "", p="", round(tbl.as.df$Prob, 2), sep="""")  "
"0","    } else {"
"0","      tbl.as.df$labels <- tbl.as.df[[1]]"
"0","    }"
"0","    "
"0","    pie(table(x), labels=tbl.as.df$labels, main=varname)"
"0","  }"
"0","}"
"0",""
"0","# gsummary.factor(mtcars$am, stats = T)"
"0",""
